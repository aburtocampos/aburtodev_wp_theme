(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var l in n)e.o(n,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:n[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,n=window.wp.blocks,l=window.wp.blockEditor,r=window.wp.components,a=window.wp.element,o=window.wp.apiFetch;var i=e.n(o);(0,n.registerBlockType)("glint/project-grid",{edit({attributes:e,setAttributes:n}){const{itemsToShow:o,postType:c,category:s,linkTitle:m,linkImage:p}=e,[d,u]=(0,a.useState)([]),[g,h]=(0,a.useState)([]),[w,b]=(0,a.useState)([]),[E,v]=(0,a.useState)(1);(0,a.useEffect)((()=>{i()({path:"/wp/v2/types"}).then((e=>{const t=Object.entries(e).filter((([e,t])=>t.viewable&&!e.startsWith("wp_")&&"attachment"!==e&&!1===t.hierarchical)).map((([e,t])=>({label:t.name,value:e})));b(t)}))}),[]),(0,a.useEffect)((()=>{c&&i()({path:`/wp/v2/${c}?per_page=${o}&page=${E}&_embed`}).then(u).catch((()=>u([])))}),[o,c,E]),(0,a.useEffect)((()=>{c&&i()({path:`/wp/v2/${c}_category?per_page=100`}).then(h).catch((()=>h([])))}),[c]);const y=(0,l.useBlockProps)({className:"project-grid-editor-preview"});return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(l.InspectorControls,null,(0,t.createElement)(r.PanelBody,{title:"Project Grid Settings",initialOpen:!0},(0,t.createElement)(r.TextControl,{label:"Items to show",type:"number",value:o,min:1,onChange:e=>n({itemsToShow:parseInt(e)||1})}),(0,t.createElement)(r.SelectControl,{label:"Post Type",value:c,options:w.length?w:[{label:"Loading...",value:""}],onChange:e=>n({postType:e,category:""})}),(0,t.createElement)(r.SelectControl,{label:"Filter by Category",value:s,options:[{label:"All",value:""},...g.map((e=>({label:e.name,value:String(e.id)})))],onChange:e=>n({category:e})}),(0,t.createElement)(r.ToggleControl,{label:"Link Title",checked:m,onChange:e=>n({linkTitle:e})}),(0,t.createElement)(r.ToggleControl,{label:"Link Image",checked:p,onChange:e=>n({linkImage:e})}))),(0,t.createElement)("div",{...y,tabIndex:0},d.length?(0,t.createElement)(t.Fragment,null,d.map((e=>{const n=e._embedded?.["wp:featuredmedia"]?.[0],l=n?.source_url||"",r=e.link||"#";return(0,t.createElement)("div",{key:e.id,className:"preview-item"},l&&p?(0,t.createElement)("a",{href:r,target:"_blank",rel:"noopener noreferrer"},(0,t.createElement)("img",{src:l,alt:e.title?.rendered,style:{width:"100%",height:"auto"}})):l?(0,t.createElement)("img",{src:l,alt:e.title?.rendered,style:{width:"100%",height:"auto"}}):null,m?(0,t.createElement)("h4",null,(0,t.createElement)("a",{href:r,target:"_blank",rel:"noopener noreferrer"},e.title?.rendered)):(0,t.createElement)("h4",null,e.title?.rendered),e.excerpt?.rendered&&(0,t.createElement)("div",{dangerouslySetInnerHTML:{__html:e.excerpt.rendered}}))})),(0,t.createElement)("div",{className:"pagination-controls"},E>1&&(0,t.createElement)("button",{onClick:()=>v(E-1)},"Anterior"),d.length===o&&(0,t.createElement)("button",{onClick:()=>v(E+1)},"Siguiente"))):(0,t.createElement)("p",null,"No items found for preview.")))},save:()=>null})})();